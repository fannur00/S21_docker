# Simple Docker

## Part 1. Готовый докер

- Возьми официальный докер-образ с nginx и выкачай его при помощи `docker pull`.
![](./img/docker_pull.png)

- Проверь наличие докер-образа через `docker images`.
![](./img/docker_img.png)

- Запусти докер-образ через `docker run -d [image_id|repository]`.

![](./img/docker_run.png)

- Проверь, что образ запустился `через docker ps`.

![](./img/docker_ps.png)

- Посмотри информацию о контейнере через `docker inspect [container_id|container_name]`.

![](./img/docker_inspect.png)

- По выводу команды определи и помести в отчёт размер контейнера, список замапленных портов и ip контейнера.


- размер контейнера

![](./img/size.png)

- список замапленных портов

![](./img/port.png)

- ip контейнера

![](./img/ip.png)

- Останови докер контейнер через `docker stop [container_id|container_name]`.
- Проверь, что контейнер остановился через docker ps.

![](./img/stop.png)

- Запусти докер с портами 80 и 443 в контейнере, замапленными на такие же порты на локальной машине, через команду run.

![](./img/run_port.png)

- Проверь, что в браузере по адресу localhost:80 доступна стартовая страница nginx.

![](./img/restart.png)


## Part 2. Операции с контейнером

- Прочитай конфигурационный файл `nginx.conf` внутри докер контейнера через команду `exec`.

![](./img/nginx.png)
![](./img/conf_nginx.png)

- Создай на локальной машине файл nginx.conf.
- Настрой в нем по пути /status отдачу страницы статуса сервера nginx.

![](./img/status_nginx.png)

- Скопируй созданный файл nginx.conf внутрь докер-образа через команду docker cp.

![](./img/docker_cp.png)

- Перезапусти nginx внутри докер-образа через команду exec.

![](./img/reload.png)

- Проверь, что по адресу `localhost:80/status` отдается страничка со статусом сервера `nginx`.

![](./img/localhost_status.png)

- Экспортируй контейнер в файл `container.tar` через команду `export`.

![](./img/export.png)

- Останови контейнер.

![](./img/stop_2.png)

- Удали образ через `docker rmi [image_id|repository]`, не удаляя перед этим контейнеры.

![](./img/rmi.png)

- Удали остановленный контейнер.

![](./img/rm.png)

- Импортируй контейнер обратно через команду `import`.

![](./img/import.png)

- Запусти импортированный контейнер.

![](./img/run_import.png)

- Проверь, что по адресу `localhost:80/status` отдается страничка со статусом сервера `nginx`.

![](./img/localhost_status1.png)

## Part 3. Мини веб-сервер

- Напиши мини-сервер на C и FastCgi, который будет возвращать простейшую страничку с надписью Hello World!.

![](./img/server.png)

- Напиши свой `nginx.conf`, который будет проксировать все запросы с 81 порта на 127.0.0.1:8080.

![](./img/server_config.png)

- Проверь, что в браузере по localhost:81 отдается написанная тобой страничка.

![](./img/localhost_81.png)

## Part 4. Свой докер

- Напиши свой докер-образ, который:собирает исходники мини сервера на FastCgi из Части 3,запускает его на 8080 порту,копирует внутрь образа написанный `./nginx/nginx.conf`, запускает `nginx`

![](./img/1.png)
![](./img/2.png)
![](./img/3.png)

- Собери написанный докер-образ через docker build при этом указав имя и тег.

![](./img/build.png)

- Проверь через docker images, что все собралось корректно.

![](./img/images.png)

- Запусти собранный докер-образ с маппингом 81 порта на 80 на локальной машине и маппингом папки `./nginx` внутрь контейнера по адресу, где лежат конфигурационные файлы `nginx'а `
- Проверь, что по localhost:80 доступна страничка написанного мини сервера.

![](./img/server_run.png)

- Допиши в `./nginx/nginx.conf` проксирование странички `/status`, по которой надо отдавать статус сервера nginx.

 - Перезапусти докер-образ.
 
 ![](./img/4.png)
 ![](./img/server_localhost.png)


## Part 5. Dockle

- Просканируй образ из предыдущего задания через `dockle [image_id|repository]`.

 ![](./img/dockle.png)

 - Исправь образ так, чтобы при проверке через dockle не было ошибок и предупреждений.

  ![](./img/dockle1.png)

## Part 6. Базовый Docker Compose

- Напиши файл `docker-compose.yml`, с помощью которого:
-  Подними докер-контейнер из Части 5 (он должен работать в локальной сети, т.е. не нужно использовать инструкцию `EXPOSE` и мапить порты на локальную машину).
Подними докер-контейнер с nginx, который будет проксировать все запросы с 8080 порта на 81 порт первого контейнера.

![](./img/11.png)
![](./img/12.png)
![](./img/13.png)
![](./img/14.png)
![](./img/15.png)